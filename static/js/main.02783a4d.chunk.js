(this.webpackJsonphacksber=this.webpackJsonphacksber||[]).push([[0],{16:function(t,e,n){},27:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(2),s=n.n(a),o=n(8),c=n.n(o),i=(n(16),n(1)),u=n.n(i),l=n(3),p=n(4),d=n(5),h=n.n(d),j=(n(7),n(18),n(9)),g=n.n(j),b={"\u0430\u043f\u0442\u0435\u043a\u0430":"apteka.png","\u043e\u0431\u0443\u0432\u044c":"shoes.png","\u043e\u0434\u0435\u0436\u0434\u0430":"shirt.png","\u0434\u043b\u044f \u0441\u043f\u043e\u0440\u0442\u0430":"sport.png","\u0434\u043b\u044f \u0434\u043e\u043c\u0430":"home.png","\u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435":"hammer.png","\u043a\u0430\u0444\u0435":"kafe.png","\u043f\u0430\u0440\u0438\u043a\u043c\u0430\u0445\u0435\u0440\u0441\u043a\u0430\u044f":"cut.png","\u043f\u0440\u043e\u0434\u0443\u043a\u0442\u044b":"shop.png"},f={"\u043f\u044f\u0442\u0435\u0440\u043e\u0447\u043a\u0430":"5.png","\u043c\u043e\u043d\u0435\u0442\u043a\u0430":"monetka.png"};function m(t){return(t=(t=(t=t.toLowerCase()).replace(" ","")).split(","))[0]}var v=function(t,e){var n=function(t,e){e=m(e),t=m(t);var n="/goofy-sber/logos/brands/",r=f[e];if(void 0===r&&void 0===(r=b[t]))return n+"default.png";return n+r}(t,e);return h.a.icon({iconUrl:n,iconRetinaUrl:n,iconSize:[18,18],iconAnchor:[20,20]})};function x(){return O.apply(this,arguments)}function O(){return(O=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",g.a.v4());case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(t){return k.apply(this,arguments)}function k(){return(k=Object(l.a)(u.a.mark((function t(e){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://eugene.gubanov.site/r.php?ip=",t.next=3,fetch("https://eugene.gubanov.site/r.php?ip="+e);case 3:return n=t.sent,t.next=6,n.json();case 6:return r=t.sent,t.abrupt("return",{lat:parseFloat(r.latitude),lng:parseFloat(r.longitude)});case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(){return(w=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:return e=t.sent,t.next=5,y(e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var N={getIp:x,getLocation_by_ip:y,ApiSetLocation:function(){return w.apply(this,arguments)},geoFindMe:function(t){var e=null,n=null;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(r){var a=r.coords.latitude,s=r.coords.longitude;e=a,n=s,console.log("success",a,s),t(e,n)}),(function(){return alert("Errno"),[null,null]})):alert("\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438 \u043d\u0435\u0442!")},viewPoint:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===e&&null===n||t.setView([e,n]),null===r||t.setZoom(r)},addMarkers:function(t,e,n){for(var r=h.a.featureGroup(),a=0;a<e.length;a++){var s=e[a];try{h.a.marker([s.point.lat,s.point.lon],{icon:v(n,s.name)}).addTo(r)}catch(o){console.log(s.point),console.log("O",a,o)}}return[function(){r.addTo(t),t.fitBounds(r.getBounds())},function(){r.removeFrom(t)}]},setResetMyLocation:function(t,e,n){var r=h.a.featureGroup();return h.a.marker([e,n],{icon:function(){var t="/goofy-sber";return h.a.icon({iconUrl:t+"/logos/self_locate.png",iconRetinaUrl:t+"/logos/self_locate.png",iconSize:[28,28],iconAnchor:[28,28]})}()}).addTo(r),[function(){r.addTo(t),t.fitBounds(r.getBounds())},function(){r.removeFrom(t)}]}},M="/goofy-sber",C=function(t){var e=t.maps;return Object(r.jsx)("div",{onClick:function(){e.zoomIn()},className:"zoom-top-bar-up zoom-top-bar-btn",children:Object(r.jsx)("img",{src:M+"/logos/plus.svg",alt:"PlusZoom"})})},S=function(t){var e=t.maps;return Object(r.jsx)("div",{onClick:function(){e.zoomOut()},className:"zoom-top-bar-down zoom-top-bar-btn",children:Object(r.jsx)("img",{src:M+"/logos/minus.svg",alt:"MinusZoom"})})},_=function(t){var e=t.maps;return Object(r.jsxs)("div",{className:"zoom-top-bar",children:[Object(r.jsx)(C,{maps:e}),Object(r.jsx)(S,{maps:e})]})},P=function(t){var e=t.handler;return Object(r.jsx)("div",{onClick:e,className:"to-image-btn btn-my-location",children:Object(r.jsx)("img",{src:M+"/logos/find.svg",alt:"MyLocation"})})},F="rugtio3557";function L(t){return t*(Math.PI/180)}function z(t,e,n,r){var a=L(n-t),s=L(r-e),o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(L(t))*Math.cos(L(n))*Math.sin(s/2)*Math.sin(s/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function B(t){return null===t?"":t<1e3?Math.round(100*(t/100).toFixed(1))+" \u043c.":(t/1e3).toFixed(2)+" \u043a\u043c."}function I(){return(I=Object(l.a)(u.a.mark((function t(e,n){var r,a,s,o,c,i,l,p=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=function(t){var e=null;try{e=z(t.point.lat,t.point.lon,n[0],n[1])}catch(r){}finally{return t.distance={text:B(e),distance:e},t}},r=p.length>2&&void 0!==p[2]&&p[2],a=p.length>3&&void 0!==p[3]?p[3]:2e3,s=p.length>4&&void 0!==p[4]?p[4]:null,(o=new URL("https://catalog.api.2gis.com/3.0/items")).searchParams.set("key",F),o.searchParams.set("locale","ru_RU"),o.searchParams.set("fields",["items.point","items.address","items.reviews","items.schedule","items.contact_groups"]),o.searchParams.set("q",e),o.searchParams.set("sort_point",n[1]+","+n[0]),null!==s&&(o.searchParams.set("viewpoint1",s[0][1]+","+s[0][0]),o.searchParams.set("viewpoint2",s[0][1]+","+s[0][0])),null!==r&&r&&o.searchParams.set("point",n[1]+","+n[0]),o.searchParams.set("radius",parseInt(a)),console.log(o.toString()),t.next=16,fetch(o.toString());case 16:return c=t.sent,t.next=19,c.json();case 19:i=t.sent;try{i.result.items=i.result.items.map(l)}catch(u){}return t.abrupt("return",i);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var R={get_by_category:function(t,e){return I.apply(this,arguments)}};function T(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return e||n?(n=n||"...",t.substr(0,e-n.length)+n):t}var U=[["\u0410\u043f\u0442\u0435\u043a\u0430.png","\u0410\u043f\u0442\u0435\u043a\u0430","\u0420\u0435\u043a\u043b\u0430\u043c\u0430, \u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c"],["\u0410\u043f\u0442\u0435\u043a\u0430.png","\u041c\u0443\u0441\u043e\u0440"],["\u0410\u043f\u0442\u0435\u043a\u0430.png","\u0425\u043b\u0435\u0431"],["\u0410\u043f\u0442\u0435\u043a\u0430.png","\u0410\u043f\u0442\u0435\u043a\u0430","\u0420\u0435\u043a\u043b\u0430\u043c\u0430, \u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c"]],A=function(t){var e=t.row,n=t.hook;console.log(e);var a="";return void 0!==e[2]&&(a=Object(r.jsx)("p",{className:"gray-color",children:e[2]})),Object(r.jsx)("div",{onClick:function(){n(e[1].toLowerCase())},className:"category-list_item",children:Object(r.jsxs)("div",{children:[Object(r.jsx)("img",{src:"/goofy-sber/logos/"+e[0]}),Object(r.jsxs)("div",{className:"text",children:[Object(r.jsx)("p",{children:e[1]}),a]})]})})},q=function(t){var e=t.hook,n=U.map((function(t){return Object(r.jsx)(A,{hook:e,row:t})}));return Object(r.jsx)("div",{className:"category-list",children:n})},E=function(t){var e=t.row,n=t.hook;console.log(e);var a="";return void 0!==e.distance.text&&""!==e.distance.text&&(a=Object(r.jsx)("p",{className:"gray-color",children:e.distance.text})),Object(r.jsxs)("div",{onClick:function(){n(e[1].toLowerCase())},className:"category-list_item",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("img",{src:"/goofy-sber/logos/close.svg"}),Object(r.jsxs)("div",{className:"text",children:[Object(r.jsx)("p",{children:T(e.name,29)}),Object(r.jsx)("p",{className:"gray-color",children:e.address_name})]})]}),a]})},Z=function(t){var e=t.data,n=t.hook;try{var a=e.map((function(t){return Object(r.jsx)(E,{hook:n,row:t})}));return Object(r.jsx)("div",{className:"category-list",children:a})}catch(s){return Object(r.jsx)("div",{className:"category-list",children:"..."})}},G=function(t){var e=t.hook,n="/goofy-sber/logos/",s=Object(a.useState)("popupClose"),o=Object(p.a)(s,2),c=o[0],i=o[1],d=Object(a.useState)(""),h=Object(p.a)(d,2),j=h[0],g=h[1],b=Object(a.useState)(!0),f=Object(p.a)(b,2),m=f[0],v=f[1],x=Object(a.useState)([]),O=Object(p.a)(x,2),y=O[0],k=O[1],w=Object(a.useState)(!1),N=Object(p.a)(w,2),M=N[0],C=(N[1],"popupOpen"),S="popupClose";function _(t){console.log("new_state:",t),i("open"===t?C:"close"===t?S:"")}function P(t){return F.apply(this,arguments)}function F(){return(F=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==n){t.next=6;break}g(""),v(!0),k([]),t.next=12;break;case 6:return g(n),t.next=9,e(n);case 9:r=t.sent,k(r),console.log("search",r);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var L="";return""===j?L=Object(r.jsxs)("div",{className:"popup-container",children:[Object(r.jsx)("h1",{className:"gray-color",children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"}),Object(r.jsx)(q,{hook:P})]}):M||(L=Object(r.jsx)("div",{className:"popup-container",children:Object(r.jsx)(Z,{data:y})})),Object(r.jsxs)("div",{id:"popup-trigger-one",className:"popup p-full border-radius "+c,children:[Object(r.jsx)("div",{onClick:function(){c===C||""===c?_("close"):c===S&&_(m?"open":"")},className:"separating-line"}),Object(r.jsx)("div",{className:"popup-container",children:Object(r.jsxs)("div",{className:"search-box",children:[Object(r.jsx)("img",{className:"search-box_img",src:n+"search.svg",alt:"search"}),Object(r.jsx)("input",{onClick:function(){_("open")},onChange:function(t){P(t.target.value)},placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043c\u0435\u0441\u0442\u043e \u0438\u043b\u0438 \u0430\u0434\u0440\u0435\u0441"}),Object(r.jsx)("img",{className:"search-box_img",src:n+"close.svg",alt:"close"})]})}),Object(r.jsx)("div",{className:"separating-line"}),L]})};function J(){}var D=function(){var t=Object(a.useState)(null),e=Object(p.a)(t,2),n=e[0],s=e[1],o=Object(a.useState)([J]),c=Object(p.a)(o,2),i=c[0],d=c[1],j=Object(a.useState)(null),g=Object(p.a)(j,2),b=g[0],f=g[1],m=Object(a.useState)([J,J]),v=Object(p.a)(m,2),x=v[0],O=v[1];function y(){return(y=Object(l.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k(e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(){return w.apply(this,arguments)}function w(){return(w=Object(l.a)(u.a.mark((function t(){var e,r,a,s=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:"\u0410\u043f\u0442\u0435\u043a\u0430",t.next=3,R.get_by_category(e,n);case 3:if(void 0===(r=t.sent).result||void 0===r.result.items){t.next=17;break}return t.prev=5,a=N.addMarkers(b,r.result.items,e),x[1](),O(a),a[0](),t.abrupt("return",r.result.items);case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0);case 16:return t.abrupt("return",[]);case 17:case"end":return t.stop()}}),t,null,[[5,13]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){function t(){return(t=Object(l.a)(u.a.mark((function t(){var e,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.ApiSetLocation();case 2:e=t.sent,s([e.lat,e.lng]);try{n=h.a.map("map",{center:[e.lat,e.lng],zoom:13}),f(n)}catch(r){console.log(r)}case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.jsxs)("div",{className:"main-map",children:[Object(r.jsx)("div",{id:"map"}),Object(r.jsx)(_,{maps:b}),Object(r.jsx)(P,{handler:function(){N.geoFindMe((function(t,e){if(null!==t&&null!==e){N.viewPoint(b,t,e,18),s([t,e]);var n=N.setResetMyLocation(b,t,e);i[0](),d([n[1]]),n[0]()}}))}}),Object(r.jsx)(G,{hook:function(t){return y.apply(this,arguments)}})]})};var V=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)("main",{children:Object(r.jsx)(D,{})})})},H=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,s=e.getLCP,o=e.getTTFB;n(t),r(t),a(t),s(t),o(t)}))};c.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(V,{})}),document.getElementById("root")),H()},7:function(t,e,n){}},[[27,1,2]]]);
//# sourceMappingURL=main.02783a4d.chunk.js.map